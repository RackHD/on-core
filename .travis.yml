language: node_js

node_js:
  - "0.10"
  - "4"

matrix:
  allow_failures:
   - node_js: "4"

services:
  - mongodb
  - rabbitmq

env:
  global:
    - secure: "by5Gz+ov6rHMmnm9ulGihQ5NywjA2gBwbD/I8f+Apu3Ca9U+7wHmbr4Vrk6Zbbj3CWlRnx2uZQCAsBkcxOO5TGvSounldef7uquXcZjZmyb+8qdO6LKRUvsWq4IGML2IWZPB6UaZyrr98UYE/XVe3w5ICWjZAohmXLI4uCiL6/p3DR2g3lTEh85Ny3giBFRhb1R0+7CycoTXtTAi/oyEq4Rh1CRfpcvQmFgce2fBdqtjC/FdABRm19QEuvX6lYGm5G3oChOXdQ5mHZINUNy6GScTwT/auDPu9YatXQGAhfb7RGKVy7qaQC7Jf1h1NTQM2NF4sL40syZcElwpfRchl5y02Gz8WRNulV40xWVbP5XSZRaLty91TMz/odLm2/C547bJ4Yp83vRa85R1BL1ILZNq7EEKEveitQ3CvDyHZXbjYI7trH3+IYaT2kqZ+OdEgPh2NsEFzua5G/Td5oJ2t+YWxct6qWpxzFhLawz8Btf4E4+OYlE/w6e4s/H94Y/i7TrdeP9Uq5s0FH4U4oHjzEmYWwSlKNGxdLUYlL9WIptfYTWlPQLZoxD7psgnZkd0D6IPmTi9v1hVpZ8+rsfXmZ/oKaRZKs3aFOb1RlrQ29fKmCNvVYmMF6+VQJiavUheFHh4eo6ju5H/ZYuhgH5mOH/On0FyQRH/QFrJQICelc0="

after_success:
 - ./node_modules/.bin/istanbul cover -x "**/spec/**" ./node_modules/.bin/_mocha --report lcovonly -- $(find spec -name '*-spec.js') -R spec --require spec/helper.js
 - cat ./coverage/lcov.info | node_modules/.bin/coveralls
 - chmod 755 ./build_children.sh
 - ./build_children.sh

notifications:
  slack:
    rooms:
    - secure: "DZ+r6cHd9kzKl0BoW2MmLnLhyPNivsjYWyRqVwjYtwNnsMZFSfQ13B6gojEw28PJmVqDu6am/bOhwD6gka8xuu5Fu7In0LMpdL4aNmV6bg/8B8CooYFG+izaa/9Cjsk9t9RG8oZggqXl/U1g4FGweczjU6UC/8WUU/QFsud1GXDZtdLm/80i+/CC1pmhKx73zcgXNWj/j4YDhTY1r3rsEM4nk5m2/CvSo9nYLY4VvTxlH1uA3OVKqDdoMPP8nX6N12qIBYJceDI8uXrBPKFfP+y6V7paq5VNIxAFYxEKkB9AUnNENgPSKvsTP0RWicstYbFosbJHw4o09e/+sui8Mj0UuK4eRfyBdTuj1/kSeUTIYCBffVLXtN5o/Hsm88Ak1Dd7gczQBXMlNQl7nXR9g38m150AMyinvyx52ZdOXiBhPRBbF9riD2fCgjxoCq8W3cVmRaU25lI/YyAMDUGaaVBVjRJCuMEMnFlXJdV2pGPIglRuPrB6llGnyCwTPNlPdsvVjWzQ6j9gV7jQb2mVvjo4c8Lvs0KI0UEAVrysWaslYd1Wgdh8HGSlPJua9Xpo7rQs5wsRqSqFwIZ038NCXWvXtZc828//KvWC+1e26puQfIjwMR/y6cqzF09h7+GkSePxYxoCqbNgSZ/u6KrOx0FOe+E4BrLl5PEtO3Y2iAg="
    on_success: never
    on_failure: always
    on_start: never

